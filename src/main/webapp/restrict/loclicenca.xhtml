<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

    <ui:composition xmlns="http://www.w3.org/1999/xhtml"
                    xmlns:h="http://java.sun.com/jsf/html"
                    xmlns:p="http://primefaces.org/ui"
                    xmlns:ui="http://java.sun.com/jsf/facelets"
                    template="./../resources/templates/principal.xhtml"
                    xmlns:f="http://java.sun.com/jsf/core">
        <ui:define name="centro">
            
            <p:fieldset legend="Atribuir licenças ao local" id="field">
                <h:form id="form_atrib">
                    <p:growl id="msg_atri" showDetail="true"/>
                    <h:inputHidden value="#{localMB.local.id}"/>
                    <h:panelGrid columns="2" styleClass="Gridlicenca" cellpadding="10" id="panellicenca">
                        <h:outputLabel value="Comarca.:"/>
                        <p:selectOneMenu id="cbcomarca" value="#{localMB.comarca.id}" style="width: 300px">
                            <f:selectItem itemLabel="Selecione comarca" itemValue=""/>
                            <f:selectItems var="com" value="#{localMB.combocomarca}" itemLabel="#{com.com_desc}" itemValue="#{com.id}"/>
                            <p:ajax update="cbforo" listener="#{localMB.selecionaForo}" event="change" process="cbcomarca"/>
                        </p:selectOneMenu>
                        <h:outputLabel value="Foro.:"/>
                        <p:selectOneMenu id="cbforo" value="#{localMB.foro.id}" style= "width: 300px">
                            <f:selectItem itemLabel="Selecione foro" itemValue=""/>
                            <f:selectItems var="foro"   value="#{localMB.comboforos}" itemLabel="#{foro.for_desc}" itemValue="#{foro.id}"/>
                            <p:ajax update="cblocal" listener="#{localMB.selecionaLocal}" event="change" process="cbforo"/>
                        </p:selectOneMenu>
                        <h:outputLabel value="Local.:"/>
                        <p:selectOneMenu id="cblocal" value="#{localMB.local}" style="width: 300px" converter="converterlocal" converterMessage="Erro de conversão">
                            <f:selectItem itemLabel="Selecione local" itemValue=""/>
                            <f:selectItems var="local" value="#{localMB.combolocais}" itemLabel="#{local.loc_desc}" itemValue="#{local}"/>
                        </p:selectOneMenu>
                        
                    </h:panelGrid>
                    <p:dataTable id="tabela" var="lic" value="#{licencasMB.desativadas}" emptyMessage="Nenhum registro encontrado" filteredValue="#{licencasMB.filtro_desativadas}" editable="true" paginator="true" rows="3" 
                         paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink}
                         {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         rowsPerPageTemplate="5,10,15" selection="#{localMB.licenca}" rowKey="#{lic.id}">
                        <p:column selectionMode="single" style="width:16px;text-align:center" />
                        <p:column filterBy="#{lic.lic_desc}" headerText="Descricao"  filterMatchMode="contains" filterStyle="width: 300px" width="200">
                            <p:cellEditor>
                                <f:facet name="output"><h:outputText value="#{lic.lic_desc}"/></f:facet>
                                <f:facet name="input"><p:inputText id="txtdesc" value="#{lic.lic_desc}" style="width:100% " label="Descricao"/></f:facet>
                            </p:cellEditor>
                        </p:column>
                        <p:column headerText="Status" width="110" style="text-align: center">
                            <h:outputText value="#{lic.status}"/>
                        </p:column> 
                    </p:dataTable>
                    <p:panel>
                            <p:commandButton action="#{localMB.SalvarLicenca}" value="Salvar" label="Salvar" icon="ui-icon-disk" update=":form_atrib"/>
                            <p:commandButton type="reset" value="Limpar" icon="ui-icon-trash"/>
                    </p:panel>
                </h:form>
            </p:fieldset>
            
        </ui:define>
    </ui:composition>
